<!DOCTYPE html>
<html>
  <head>
    <title>treeTimer</title>
    <style>
      html {
        background-color: cadetblue;
        color: white;
      }
      img {
        width: 75%
      }
      button {
        width: 12%;
        height: 50px;
        border: 1px solid black;
        border-radius: 20px;
      }
    </style>
  </head>
<body>
  <center>
    <div id="1">
      <a id="buffhours">0</a><a id="hours"></a> :
      <a id="buffminutes">0</a><a id="minutes"></a> :
      <a id="buffsec">0</a>
      <a id="seconds">  
      </a>
    </div><hr>
  </center>
  <center>
    <div id="2"></div>

    <!-- small tree -->
    <img src="https://github.com/treeTimer/treeTimer.github.io/blob/main/maintree.png?raw=true">
   <hr>
   <button id="mintime" onclick="setTime(-1)">-1m</button>
   <button id="timeset">
     <a id="stuff">
       <a id="timesetted">1</a>m 
     </a>
   </button>
   <button id="addtime" onclick="setTime(1)">+1m</button> <br> <br> <br>
   <button id="start" onclick="startTimer(1)">Start</button>
  </center>
</body>
</html>

<!-- Telegram LINK: https://t.me/treetimer -->
 <!-- Telegram LINK: https://t.me/treetimer -->
  <!-- Telegram LINK: https://t.me/treetimer -->
   <!-- Telegram LINK: https://t.me/treetimer -->

<script>
//user data from localStorage
var savedUser = JSON.parse(localStorage.getItem('user'))
console.log(savedUser)
//text
let hoursScreen = document.getElementById("hours"),
  minutesScreen = document.getElementById('minutes'),
  secondsScreen = document.getElementById('seconds'),
  buffsecScreen = document.getElementById('buffsec'),
  buffminutesScreen = document.getElementById('buffminutes'),
  buffhoursScreen = document.getElementById('buffhours');
//buttons
let addButt = document.getElementById("addtime"),
  minButt = document.getElementById('mintime')
  startButt = document.getElementById('start');
//time RIGHT NOW when user open the app
var started2 = 0;
var now = new Date();
console.log(now)
var user = {
  "hoursNow":now.getHours(),
  "minutesNow":now.getMinutes(),
  "secondsNow":now.getSeconds()
}
console.log(user)
//check is timer complete
if (savedUser.planedHours<=now.getHours() && savedUser.planedMinutes<=now.getMinutes()) {
  started2 = false;
}
else {
  started2 = true;
}
console.log(started2)
//var for started timer
if (savedUser.started === true && started2 === true) {
  addButt.disabled = true; minButt.disabled = true; startButt.disabled = true;
}
else {
  addButt.disabled = false; minButt.disabled = false; startButt.disabled = false;
}


//MAIN
function main() {
  var now = new Date();
  console.log(now)
  var user = {
    "hoursNow":now.getHours(),
    "minutesNow":now.getMinutes(),
    "secondsNow":now.getSeconds()
  }

  //innerHTML time right now///
  hoursScreen.innerHTML = now.getHours();
  minutesScreen.innerHTML = now.getMinutes();
  function seconds() {
    if (now.getSeconds() < 10) {
      buffsecScreen.innerHTML = '0';
      secondsScreen.innerHTML = now.getSeconds();
    }
    else {
      buffsecScreen.innerHTML = '';
      secondsScreen.innerHTML = now.getSeconds();
    }
  }
  function minutes() {
    if (now.getMinutes() < 10) {
      buffminutesScreen.innerHTML = '0';
      minutesScreen.innerHTML = now.getMinutes();
    }
    else {
      buffminutesScreen.innerHTML = '';
      minutesScreen.innerHTML = now.getMinutes();
    }
  }
  function hours() {
    if (now.getHours() < 10) {
      buffhoursScreen.innerHTML = '0';
      hoursScreen.innerHTML = now.getHours();
    }
    else {
      buffhoursScreen.innerHTML = '';
      hoursScreen.innerHTML = now.getHours();
    }
  }
  hours(), seconds(), minutes()
  /////////////////////////////


}
////Timer
function startTimer(n) {
  addButt.disabled = true; minButt.disabled = true; startButt.disabled = true; //off all buttons
  started = true; //started timer
  var now = new Date(); //Date for saving it in user
  var planedHours = now.getHours();
  var planedMinutes = now.getMinutes()+n;
  var planedSeconds = now.getSeconds();
  console.log(now)

  if (planedMinutes >= 60) {
    planedHours = planedHours+1
    planedMinutes = planedMinutes-60
  }
  console.log(planedHours, planedMinutes);

  var user = {
    "hoursNow":now.getHours(),    //
    "minutesNow":now.getMinutes(),// time lol
    "secondsNow":now.getSeconds(),//
    "started": started,
    "doTime": n, //time in timer
    "planedHours": planedHours,
    "planedMinutes": planedMinutes,
    "planedSeconds": planedSeconds
  } //user

  localStorage.setItem('user', JSON.stringify(user)); //save user data to localStorage


}

// //RESET FUNCTION FOR DEBUGGING
// function reset() {
//   started = false;
//   var now = new Date();
//   console.log(now)
//   var user = {
//     "hoursNow":now.getHours(),
//     "minutesNow":now.getMinutes(),
//     "secondsNow":now.getSeconds(),
//     "started": started
//   }
//   localStorage.setItem('user', JSON.stringify(user));
// } reset();

//MAIN TIMER
let timerId = setInterval(() => main(), 1000);


</script>

<!-- Telegram LINK: https://t.me/treetimer -->
 <!-- Telegram LINK: https://t.me/treetimer -->
  <!-- Telegram LINK: https://t.me/treetimer -->
   <!-- Telegram LINK: https://t.me/treetimer -->
